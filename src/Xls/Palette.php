<?php

namespace Xls;

class Palette
{
    /**
     * Return Excel 97+ default palette
     * @return array
     */
    public static function getXl97Palette()
    {
        return array(
            array(0x00, 0x00, 0x00, 0x00), // 8
            array(0xff, 0xff, 0xff, 0x00), // 9
            array(0xff, 0x00, 0x00, 0x00), // 10
            array(0x00, 0xff, 0x00, 0x00), // 11
            array(0x00, 0x00, 0xff, 0x00), // 12
            array(0xff, 0xff, 0x00, 0x00), // 13
            array(0xff, 0x00, 0xff, 0x00), // 14
            array(0x00, 0xff, 0xff, 0x00), // 15
            array(0x80, 0x00, 0x00, 0x00), // 16
            array(0x00, 0x80, 0x00, 0x00), // 17
            array(0x00, 0x00, 0x80, 0x00), // 18
            array(0x80, 0x80, 0x00, 0x00), // 19
            array(0x80, 0x00, 0x80, 0x00), // 20
            array(0x00, 0x80, 0x80, 0x00), // 21
            array(0xc0, 0xc0, 0xc0, 0x00), // 22
            array(0x80, 0x80, 0x80, 0x00), // 23
            array(0x99, 0x99, 0xff, 0x00), // 24
            array(0x99, 0x33, 0x66, 0x00), // 25
            array(0xff, 0xff, 0xcc, 0x00), // 26
            array(0xcc, 0xff, 0xff, 0x00), // 27
            array(0x66, 0x00, 0x66, 0x00), // 28
            array(0xff, 0x80, 0x80, 0x00), // 29
            array(0x00, 0x66, 0xcc, 0x00), // 30
            array(0xcc, 0xcc, 0xff, 0x00), // 31
            array(0x00, 0x00, 0x80, 0x00), // 32
            array(0xff, 0x00, 0xff, 0x00), // 33
            array(0xff, 0xff, 0x00, 0x00), // 34
            array(0x00, 0xff, 0xff, 0x00), // 35
            array(0x80, 0x00, 0x80, 0x00), // 36
            array(0x80, 0x00, 0x00, 0x00), // 37
            array(0x00, 0x80, 0x80, 0x00), // 38
            array(0x00, 0x00, 0xff, 0x00), // 39
            array(0x00, 0xcc, 0xff, 0x00), // 40
            array(0xcc, 0xff, 0xff, 0x00), // 41
            array(0xcc, 0xff, 0xcc, 0x00), // 42
            array(0xff, 0xff, 0x99, 0x00), // 43
            array(0x99, 0xcc, 0xff, 0x00), // 44
            array(0xff, 0x99, 0xcc, 0x00), // 45
            array(0xcc, 0x99, 0xff, 0x00), // 46
            array(0xff, 0xcc, 0x99, 0x00), // 47
            array(0x33, 0x66, 0xff, 0x00), // 48
            array(0x33, 0xcc, 0xcc, 0x00), // 49
            array(0x99, 0xcc, 0x00, 0x00), // 50
            array(0xff, 0xcc, 0x00, 0x00), // 51
            array(0xff, 0x99, 0x00, 0x00), // 52
            array(0xff, 0x66, 0x00, 0x00), // 53
            array(0x66, 0x66, 0x99, 0x00), // 54
            array(0x96, 0x96, 0x96, 0x00), // 55
            array(0x00, 0x33, 0x66, 0x00), // 56
            array(0x33, 0x99, 0x66, 0x00), // 57
            array(0x00, 0x33, 0x00, 0x00), // 58
            array(0x33, 0x33, 0x00, 0x00), // 59
            array(0x99, 0x33, 0x00, 0x00), // 60
            array(0x99, 0x33, 0x66, 0x00), // 61
            array(0x33, 0x33, 0x99, 0x00), // 62
            array(0x33, 0x33, 0x33, 0x00), // 63
        );
    }

    /**
     * @param $index
     * @param $red
     * @param $green
     * @param $blue
     *
     * @throws \Exception
     */
    public static function validateColor($index, $red, $green, $blue)
    {
        // Check that the colour index is the right range
        if ($index < 8 || $index > 64) {
            throw new \Exception("Color index $index outside range: 8 <= index <= 64");
        }

        // Check that the colour components are in the right range
        if (($red < 0 || $red > 255)
            || ($green < 0 || $green > 255)
            || ($blue < 0 || $blue > 255)
        ) {
            throw new \Exception("Color component outside range: 0 <= color <= 255");
        }
    }
}
